###################################
1.7.2 から 2.0.0 へのアップグレード
###################################

アップグレードの前には index.php
を静的ページと置き換えてサイトを停止してください。



ステップ 1: CodeIgniter ファイルの更新
======================================

"system" フォルダ内の application フォルダを 除く
すべてのファイルとディレクトリを置き換えます。

.. note:: これらのディレクトリの中のファイルを更新している場合は、必ず最初にコピーを残しておいてください。



ステップ 2: 必要に応じて get_dir_file_info() の調整
===================================================

バージョン2.0.0では、 :doc:`ファイルヘルパー <../helpers/file_helper>`
の get_dir_file_info() に後方非互換の変更があります。CodeIgniter
では後方互換性の無い変更は非常にまれですが、 これは簡単に深刻なサーバ
のパフォーマンスの問題を生じさせることから、この変更は正当化できる気が
します。もし、このヘルパー関数で再帰的な処理 *必要*なら、 第2引数
$top_level_only を FALSE に設定してください。


::

	get_dir_file_info('/path/to/directory', FALSE);




ステップ 3: プラグインをヘルパーに変換
======================================

2.0.0 では、機能的にはヘルパーと同じでありながら拡張性の無い"プラグイ
ン"は排除されます。プラグインファイルを filename_pi.php から
filename_helper.php にリネームし、それらを helpers
フォルダに移動して、以下のような場合を:

::

	$this->load->plugin('foo');

から下記に変更します。

::

	$this->load->helper('foo');





Step 4: 暗号化保存されているデータの更新
========================================

.. note:: もし、アプリケーションが暗号化ライブラリを使用していなかったり、暗号化されたデータを永続的に保存していなかったり、または、Mcrypt
をサポートしていない環境の場合は、このステップをスキップしてください。

暗号化ライブラリは、暗号化強度やパフォーマンスなど多くの点で改良されま
した。 その結果、以前の暗号化ライブラリで暗号化されたデータを復号化す
ることが不可能になっています。 一連の処理を助けるために、以前のアルゴ
リズムで復号化し新たに改良されたメソッドで暗号化しなおす新しいメソッド
encode_from_legacy() が追加されています。 このメソッドは、その場である
いはまとめて、以前の暗号化データを新しい暗号化データに簡単に置き換える
ことができます。

暗号化ライブラリのドキュメントの :doc:`このメソッドの使い方
<../libraries/encryption.html#legacy>` を読んでください。



Step 5: 互換性ヘルパーの読み込みの削除
======================================

互換性ヘルパーは CodeIgniter
のコアから削除されました。すべてのメソッドは動作環境の PHP
バージョンではネイティブに含まれています。



Step 6: クラスの継承の更新
==========================

すべてのコアクラスは現在 CI_
という接頭辞を付けられています。モデルとコントローラは、おのおの
CI_Model と CI_Controller を継承するよう更新してください。



Step 7: 親クラスのコンストラクタの呼び出しの更新
================================================

すべてのネイティブの CodeIgniter のクラスは PHP 5 の規約 __construct()
を使用します。継承されたライブラリは parent::__construct()
を呼び出すように更新してください。



ステップ 8: ユーザガイドの更新
==============================

ローカルにあるユーザガイドも、画像ファイルを含めて新しいバージョンのも
ので置き換えてください。

[ 訳注: ドキュメントされていませんが、 :doc:`入力クラス
<../libraries/input>` の xss_clean() メソッドは
:doc:`セキュリティクラス <../libraries/security>`
に移動されましたので変更が必要です ]

